{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/making-a-verlet-physics-engine-in-javascript","result":{"data":{"markdownRemark":{"excerpt":"Have you ever wondered if you can make your own physics engine in JavaScript? If\r\nso, you have come to the right place. We are going to…","html":"<p>Have you ever wondered if you can make your own physics engine in JavaScript? If\r\nso, you have come to the right place. We are going to build a Physics engine\r\nfrom scratch in JavaScript.</p>\n<p>Before we start, I should mention that this tutorial assumes you have a good\r\nunderstanding of Vectors. Don’t worry if you do not yet have this understanding\r\n— Vectors are simple: get the Vector.js.</p>\n<h2 id=\"What-Is-Verlet-Physics\" style=\"position:relative;\"><a href=\"#What-Is-Verlet-Physics\" aria-label=\"What Is Verlet Physics permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What Is Verlet Physics?</h2>\n<p>According to Wikipedia:</p>\n<blockquote>\n<p>Verlet integration is a numerical method used to integrate Newton’s equations\r\nof motion. It is frequently used to calculate trajectories of particles in\r\nmolecular dynamics simulations and computer graphics. The algorithm was first\r\nused in 1791 by Delambre and has been rediscovered many times since then, most\r\nrecently by Loup Verlet in the 1960s for use in molecular dynamics.</p>\n</blockquote>\n<p>In simple terms, Verlet physics is just a system of connected dots.</p>\n<h3 id=\"In-a-Verlet-system-we-have-2-main-components\" style=\"position:relative;\"><a href=\"#In-a-Verlet-system-we-have-2-main-components\" aria-label=\"In a Verlet system we have 2 main components permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>In a Verlet system, we have 2 main components:</h3>\n<ol>\n<li>Points (dots)</li>\n<li>Constraints (sticks)</li>\n</ol>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 220px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/939075716d1daed1ba18d841316f59e4/c8042/verlet_box.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 103.37837837837837%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABJklEQVQ4y81UPU/DMBDt//8FMDEDCyMrbEggBgZGFkCAGohrkzi27x7yJW2chqauVCosPcU53727d/6YYc9j9meEzLz6LpHa07Xf5lmEOdhIuL6QO9ZjRhWSqaCPzkDvBbjU4E8loASsK5jjc/jntzaWpiQHgrt/BDdO5hxCDx8kOCZwNw+ghcmTzKYeZB34FKVUyM5L0slNWcmOQYHGuxntpW59vhZg2+RVKH0iGlYdyZTufZXekbCrUOzznmzZiq2EA8kJ4YAslb8TYSSJ//O+Z7K70dZVKD2sMyXDOnChwKbafKLjEXI+4+rZBt8nF6CnF3BlW2nKJNBir04vEV4/8gjt1W1LVjfg2o7hPOz1nfT68He5bTxtf2k6n8kK//eLvS/CH13tfTClNDEaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"A Box. Connected With Dots And Sticks\"\n        title=\"A Box. Connected With Dots And Sticks\"\n        src=\"/static/939075716d1daed1ba18d841316f59e4/c8042/verlet_box.png\"\n        srcset=\"/static/939075716d1daed1ba18d841316f59e4/12f09/verlet_box.png 148w,\n/static/939075716d1daed1ba18d841316f59e4/c8042/verlet_box.png 220w\"\n        sizes=\"(max-width: 220px) 100vw, 220px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">A Box. Connected With Dots And Sticks</figcaption>\n  </figure></p>\n<h2 id=\"Dots\" style=\"position:relative;\"><a href=\"#Dots\" aria-label=\"Dots permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dots</h2>\n<p>The dots have basic physics applied to them. We have to keep track of the dots’\r\ncurrent and old positions to add the physics behavior to them — you'll see this\r\nwhen we implement it.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Dot.js</span>\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Dot</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oldpos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>friction <span class=\"token operator\">=</span> <span class=\"token number\">0.97</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>groundFriction <span class=\"token operator\">=</span> <span class=\"token number\">0.7</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>gravity <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vector</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'#e62a4f'</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mass <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>We have the basic setup, now let's render the dots and make them move.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Dot.js</span>\r\n<span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">let</span> vel <span class=\"token operator\">=</span> Vector<span class=\"token punctuation\">.</span><span class=\"token function\">sub</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oldpos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span>  vel<span class=\"token punctuation\">.</span><span class=\"token function\">mult</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>friction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token comment\">// if the point touches the ground set groundFriction</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">>=</span> <span class=\"token constant\">CANVAS_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius <span class=\"token operator\">&amp;&amp;</span> vel<span class=\"token punctuation\">.</span><span class=\"token function\">magSq</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0.000001</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">var</span> m <span class=\"token operator\">=</span> vel<span class=\"token punctuation\">.</span><span class=\"token function\">mag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    vel<span class=\"token punctuation\">.</span>x <span class=\"token operator\">/=</span> m<span class=\"token punctuation\">;</span>\r\n    vel<span class=\"token punctuation\">.</span>y <span class=\"token operator\">/=</span> m<span class=\"token punctuation\">;</span>\r\n    vel<span class=\"token punctuation\">.</span><span class=\"token function\">mult</span><span class=\"token punctuation\">(</span>m <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>groundFriction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>oldpos<span class=\"token punctuation\">.</span><span class=\"token function\">setXY</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>vel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span>  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>gravity<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The update function will update the position and handle the physics of the dot.</p>\n<p>To do Verlet integration, we have to calculate velocity based on dots old\r\nposition.</p>\n<p>In the first line, we are <strong>subtracting the current position from the old\r\nposition to get the desired velocity.</strong> After calculating the velocity, we apply\r\nfriction to the dots, so they come to rest instead of sliding forever.</p>\n<p>Then, we update the old position by saying\r\n<code class=\"language-text\">this.oldpos.setXY(this.pos.x, this.pos.y)</code> and add the velocity and gravity to\r\nthe position.</p>\n<p>We also want to make them stay inside the canvas, so we have to add some checks.\r\nWe will also add another function: <code class=\"language-text\">constrain()</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Dot.js</span>\r\n<span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">></span> <span class=\"token constant\">CANVAS_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token constant\">CANVAS_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">></span> <span class=\"token constant\">CANVAS_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token constant\">CANVAS_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Let’s add the render method too:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Dot.js</span>\r\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">arc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>radius<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> Math<span class=\"token punctuation\">.</span><span class=\"token constant\">PI</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">closePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Setting up:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js | setup</span>\r\n<span class=\"token keyword\">let</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> <span class=\"token constant\">CANVAS_WIDTH</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> <span class=\"token constant\">CANVAS_HEIGHT</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">;</span>\r\ncanvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token constant\">CANVAS_WIDTH</span><span class=\"token punctuation\">;</span>\r\ncanvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token constant\">CANVAS_HEIGHT</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">let</span> dots <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  dots<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\r\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">new</span> <span class=\"token class-name\">Dot</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token constant\">CANVAS_WIDTH</span><span class=\"token punctuation\">,</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token constant\">CANVAS_HEIGHT</span><span class=\"token punctuation\">)</span>\r</span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CANVAS_WIDTH</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CANVAS_HEIGHT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> d <span class=\"token keyword\">of</span> dots<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r</span><span class=\"gatsby-highlight-code-line\">    d<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">    d<span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">    d<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span>\r</span>\r\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>We added a lot more dots in random positions and then <code class=\"language-text\">update()</code> <code class=\"language-text\">constrain()</code>\r\n<code class=\"language-text\">render()</code> them.</p>\n<p>Let's see what that looks like:</p>\n<iframe src=\"https://codepen.io/anuraghazra/embed/preview/VOpJJR?default-tab=results\" style=\"width:100%; height:300px;\"></iframe>\n<p>Excellent — it's just a start, but finally, we have something.</p>\n<p>Now we are going to add the sticks!</p>\n<h2 id=\"Sticks\" style=\"position:relative;\"><a href=\"#Sticks\" aria-label=\"Sticks permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sticks</h2>\n<p>Sticks are the core of Verlet physics. Sticks make sure that the dots don’t get\r\ntoo far or too close to each other — they constrain dots to a certain distance.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 470px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/56e47ba4ae9abd84b137a79732a1d8a9/f96db/constraint_particle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQoz6VTyXbDIAzM/39bL13SvFzdeAvBGCV4AST1Aa2D3ZvLBTTSaBngwP9Yh5+diC7FTjIh3s/ve8lMpYUnTMTM9vzpmmoxmXkiP5CL8TmZqKzLjBu8+nrVUiYzIcb0WjVLwJPcNi0zI6KNK5ABNIR25nl2EZmqizl9pDFX5LoJKcdxFEK0bUiklQIA51xVVUopZr4bI+PhT+W62bTdA/SxcjAjMl+K4fi6rYxEhayX8TD6zOk4lF9pFozkhx3UpJPAK7VvOGzUJtA8jbna9Kvz5p794+1l7z0TobwR5XkZvU/951rECWhFds5Kra1zi1reeyFE13ULQogAoLouhWVve9fH+AYEQzoUA7kRhgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"https://slsdo.github.io/blob-family/#constraint\"\n        title=\"https://slsdo.github.io/blob-family/#constraint\"\n        src=\"/static/56e47ba4ae9abd84b137a79732a1d8a9/f96db/constraint_particle.png\"\n        srcset=\"/static/56e47ba4ae9abd84b137a79732a1d8a9/12f09/constraint_particle.png 148w,\n/static/56e47ba4ae9abd84b137a79732a1d8a9/e4a3f/constraint_particle.png 295w,\n/static/56e47ba4ae9abd84b137a79732a1d8a9/f96db/constraint_particle.png 470w\"\n        sizes=\"(max-width: 470px) 100vw, 470px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">https://slsdo.github.io/blob-family/#constraint</figcaption>\n  </figure></p>\n<p><strong>Stick.js</strong> class is relatively simple. It will take two <strong>Dots</strong> as an\r\nargument and a length. But if the length is not defined, we will calculate the\r\nlength based on the dot’s position.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Stick.js</span>\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Stick</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p1<span class=\"token punctuation\">,</span> p2<span class=\"token punctuation\">,</span> length</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint <span class=\"token operator\">=</span> p1<span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint <span class=\"token operator\">=</span> p2<span class=\"token punctuation\">;</span>\r</span>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stiffness <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'#f5476a'</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// if the length is not given then calculate the distance based on the position</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span><span class=\"token function\">dist</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span>    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">=</span> length<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now let's add the actual core of the algorithm, This resolves and updates the\r\ndot’s position based on the stick’s distance, ultimately constraining it to a\r\ncertain distance from all other dots.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Stick.js</span>\r\n<span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token comment\">// calculate the distance between two dots</span>\r\n  <span class=\"token keyword\">let</span> dx <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">let</span> dy <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\r\n  <span class=\"token comment\">// pythagoras theorem</span>\r\n  <span class=\"token keyword\">let</span> dist <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span>dx <span class=\"token operator\">*</span> dx <span class=\"token operator\">+</span> dy <span class=\"token operator\">*</span> dy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token comment\">// calculate the resting distance betwen the dots</span>\r\n  <span class=\"token keyword\">let</span> diff <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> dist<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> dist <span class=\"token operator\">*</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stiffness<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// getting the offset of the points</span>\r\n  <span class=\"token keyword\">let</span> offsetx <span class=\"token operator\">=</span> dx <span class=\"token operator\">*</span> diff <span class=\"token operator\">*</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">let</span> offsety <span class=\"token operator\">=</span> dy <span class=\"token operator\">*</span> diff <span class=\"token operator\">*</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// calculate mass</span>\r\n  <span class=\"token keyword\">let</span> m1 <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>mass<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">let</span> m2 <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">/</span> m1<span class=\"token punctuation\">;</span>\r\n  m1 <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>mass <span class=\"token operator\">/</span> m1<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// and finally apply the offset with calculated mass</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pinned<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-=</span> offsetx <span class=\"token operator\">*</span> m1<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-=</span> offsety <span class=\"token operator\">*</span> m1<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pinned<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+=</span> offsetx <span class=\"token operator\">*</span> m2<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+=</span> offsety <span class=\"token operator\">*</span> m2<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Okay, I think we are good to go! Let’s add the render function:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Stick.js</span>\r\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">beginPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span>strokeStyle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">moveTo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>startPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">lineTo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>endPoint<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">stroke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">closePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Setting up:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js | setup</span>\r\n<span class=\"token keyword\">let</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> <span class=\"token constant\">CANVAS_WIDTH</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> <span class=\"token constant\">CANVAS_HEIGHT</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">;</span>\r\ncanvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token constant\">CANVAS_WIDTH</span><span class=\"token punctuation\">;</span>\r\ncanvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token constant\">CANVAS_HEIGHT</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// arrays</span>\r\n<span class=\"token keyword\">let</span> dots <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">let</span> sticks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r</span>\r\n<span class=\"token comment\">// forming a BOX</span>\r\ndots<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Dot</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// x, y, vx, vy</span>\r\ndots<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Dot</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\ndots<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Dot</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\ndots<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Dot</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// sticks</span>\r\n<span class=\"gatsby-highlight-code-line\">sticks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Stick</span><span class=\"token punctuation\">(</span>dots<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dots<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r</span><span class=\"gatsby-highlight-code-line\">sticks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Stick</span><span class=\"token punctuation\">(</span>dots<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dots<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r</span><span class=\"gatsby-highlight-code-line\">sticks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Stick</span><span class=\"token punctuation\">(</span>dots<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dots<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r</span><span class=\"gatsby-highlight-code-line\">sticks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Stick</span><span class=\"token punctuation\">(</span>dots<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dots<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r</span><span class=\"gatsby-highlight-code-line\">sticks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Stick</span><span class=\"token punctuation\">(</span>dots<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> dots<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CANVAS_WIDTH</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CANVAS_HEIGHT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> d <span class=\"token keyword\">of</span> dots<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    d<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    d<span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    d<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> s <span class=\"token keyword\">of</span> sticks<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r</span><span class=\"gatsby-highlight-code-line\">    s<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">    s<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span>\r</span>\r\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Let’s see the results:</p>\n<iframe src=\"https://codepen.io/anuraghazra/embed/preview/qGmWmZ?default-tab=results\" style=\"width:100%; height:300px;\"></iframe>\n<p>As you can see, we have a box! Well, a box that acts like it’s made of Jello,\r\nThat’s because, in a single frame, one update per stick is not enough to make\r\nthe dots rest at their length. We have to iterate the simulation as many times\r\nas we can — the more the iterations, the more the rigid box will be.</p>\n<p>Adding these lines to the existing code will make the box rigid:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js | setup</span>\r\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">const</span> <span class=\"token constant\">ITERATION</span> <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// max physics iterations per frame</span>\r</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CANVAS_WIDTH</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CANVAS_HEIGHT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// iterate over the simulation</span>\r\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token constant\">ITERATION</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r</span>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> d <span class=\"token keyword\">of</span> dots<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      d<span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> s <span class=\"token keyword\">of</span> sticks<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      s<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> d <span class=\"token keyword\">of</span> dots<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    d<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    d<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> s <span class=\"token keyword\">of</span> sticks<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    s<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    s<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<iframe src=\"https://codepen.io/anuraghazra/embed/preview/gJWpmX?default-tab=results\" style=\"width:100%; height:300px;\"></iframe>\n<p>Looks amazing, isn’t it?</p>\n<h2 id=\"Entityjs-managing-dots-and-sticks-in-one-place\" style=\"position:relative;\"><a href=\"#Entityjs-managing-dots-and-sticks-in-one-place\" aria-label=\"Entityjs managing dots and sticks in one place permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Entity.js: managing dots and sticks in one place</h2>\n<p>Okay, now we have Dot.js and Stick.js. Both are working nicely, but the problem\r\nis we don't have much control over how we use them.</p>\n<p>We will create an Entity Class that will easily handle the Updates and Renders\r\nof the Verlet Object. I'm going to paste the whole code here — it’s nothing\r\nspecial:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Entity.js</span>\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Entity</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">iterations</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sticks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>iterations <span class=\"token operator\">=</span> iterations <span class=\"token operator\">||</span> <span class=\"token number\">16</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">addDot</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> vx<span class=\"token punctuation\">,</span> vy</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Dot</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> vx<span class=\"token punctuation\">,</span> vy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">addStick</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p1<span class=\"token punctuation\">,</span> p2<span class=\"token punctuation\">,</span> length</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sticks<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Stick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">[</span>p1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">[</span>p2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">updatePoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">updateSticks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sticks<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sticks<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">updateContrains</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">renderPoints</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dots<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token function\">renderSticks</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sticks<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sticks<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updatePoints</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>iterations<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateSticks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">updateContrains</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderPoints</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">renderSticks</span><span class=\"token punctuation\">(</span>ctx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Using the Entity Class:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// index.js | setup</span>\r\n<span class=\"token operator\">...</span>\r\n<span class=\"token keyword\">let</span> box <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Entity</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token comment\">// x, y, vx, vy added random velocity in first dot to make the box rotate a little bit</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addDot</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100.0</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addDot</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addDot</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addDot</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\r\n\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addStick</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addStick</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addStick</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addStick</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\nbox<span class=\"token punctuation\">.</span><span class=\"token function\">addStick</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token operator\">...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Yes, this is looking pretty clean and manageable!</p>\n<p>Let's take a look at the final result:</p>\n<iframe src=\"https://codepen.io/anuraghazra/embed/preview/JqNdQW?default-tab=results\" style=\"width:100%; height:300px;\"></iframe>\n<p>Now we can create lots of fun Verlet Shapes with this Entity.js class!</p>\n<h2 id=\"Verlyjs-A-physics-engine-I-wrote\" style=\"position:relative;\"><a href=\"#Verlyjs-A-physics-engine-I-wrote\" aria-label=\"Verlyjs A physics engine I wrote permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Verly.js: A physics engine I wrote</h2>\n<p>Verly.js is a Robust Verlet physics engine I wrote. It has many cool features:</p>\n<ol>\n<li>Attraction — Repulsion behavior</li>\n<li>Basic Shapes</li>\n<li>Box, Hexagon, Cloth, Rope, Ragdoll</li>\n<li>Cloth Tearing</li>\n<li>Typography and Text</li>\n</ol>\n<p>With Verly.js you can create a tearable cloth in just 15 lines of code:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token comment\">// Verly.js | demo</span>\r\n<span class=\"token keyword\">let</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> width <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token number\">800</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> height <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">600</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">let</span> verly <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Verly</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">let</span> cloth <span class=\"token operator\">=</span> verly<span class=\"token punctuation\">.</span><span class=\"token function\">createCloth</span><span class=\"token punctuation\">(</span><span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">,</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span>\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">clearRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"gatsby-highlight-code-line\">  verly<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r</span><span class=\"gatsby-highlight-code-line\">  cloth<span class=\"token punctuation\">.</span><span class=\"token function\">tear</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// tear threshold</span>\r</span>  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span>animate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token function\">animate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Demo: <a href=\"https://anuraghazra.github.io/Verly.js/\">https://anuraghazra.github.io/Verly.js/</a></p>\n<p>Source-code: <a href=\"https://github.com/anuraghazra/Verly.js\">https://github.com/anuraghazra/Verly.js</a></p>\n<p>Examples: <a href=\"https://anuraghazra.github.io/Verly.js/examples\">https://anuraghazra.github.io/Verly.js/examples</a></p>\n<p>Take a look at some of the examples in my Verly.js Physics Engine, which I\r\ncreated some time ago. I added almost everything in that engine.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 262px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6a569e78c01efa99e6034f1229bd91e2/8ff13/example1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.08108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACNklEQVQ4y61U71PTQBDt//8vOCJ+cHRGHATH0bHQQae2tIINFEpLLUWqgNCSNG1zvbu9e04uP0xJQv3AzWRus8m9vH37sgUsWVrreI9iRHvGKiwFUSqIlVrIJ/dcwCygAEwnYvX/gPdfUu4UsjcwMa83oYVcClzIKoGGNujmDtTug61ughptsKfroJMzzD9VIM8v07reZ5h8KLsXYCtvQWULtHtoAP1Lli3w10XzIWWPoblInS0kb7SUmFcs0H4LVG6AuhfQzgTanULPGNTQAR39gCzV4T15AzVj+SVHSV6sQmzsQA2uoRmHnswCwLsxtDc397R3bJirW/ufC7IY0uUNqNYE7bWg3Zk5bA6NxtBDO4gZh7oeQW7X4a2sG63TgOFX5qUa+NqWKcuwcSZQV7fga0XI6gG04wZMpx5kuQF1+jPueLrkMCE/70P52k096JED9WdkGiF3vkEPnUAC2wVVDsBefoDs/1rw6iLDqgX2bMM0Rc950JCRY0r2gQ07vzlXQ1DFgmy0jVdzNfRtoHoD0FcL1DmHJhWARp322TEOsjrgrz5CdsOSSWX4MExyqw226rM8MRpFltETzzCk721Q/Qii3IBo9VJ/TQEhwyihbNf4TZTqEO++xKb2QXzdZHEX3vPNmECyIbnDwei5XYM8PIXYqgVdrjXBXryHHk8gzwbQQsTNTBn7oUkj+78hOn0Ti+Ne7iBZOm0MMFHmrHxohD0IGAseAiR/M50ztQt45PXogH8BjcldNOOMr1AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Spherical Shapes anuraghazra.github.io\"\n        title=\"Spherical Shapes anuraghazra.github.io\"\n        src=\"/static/6a569e78c01efa99e6034f1229bd91e2/8ff13/example1.png\"\n        srcset=\"/static/6a569e78c01efa99e6034f1229bd91e2/12f09/example1.png 148w,\n/static/6a569e78c01efa99e6034f1229bd91e2/8ff13/example1.png 262w\"\n        sizes=\"(max-width: 262px) 100vw, 262px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Spherical Shapes anuraghazra.github.io</figcaption>\n  </figure>\r\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 320px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/935dca25bf391f1a9ba931ef63df78bb/72799/example2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 109.45945945945948%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADzUlEQVQ4y21VW29UZRQ9P8HEf+FPMD744B/xwXd9MvFRgon4gEaJBRQIRsqUghUtbSkFpi30fp9poTMtbae3acvMmXO/L13rcFoS+JIvc+Y7O+vba+219zGyJEU4W0G4vK4dVWqIqnUEUysIxucRvdxCOFtFuPhCv/GrPQSTy0j2jhBV6siSBFzJ/hHSjgMjC0JkWYa0ZSJceom4voNwflUA0YtXiDcaCCaWEIzNIZhaRjC+kL+rbSOYXELcOBQg/ycnJox4aw+p5wskdTyBRmubCiyyI1g4t4pwYS0HnqnA++dpHlvfESDPsjAi4L7Qo9WNnPZKTS/jzV2E82sCida34Jdn4fYMIartSAomwDMu0s78AJTPCCs1xNv7uUZz1ZzubBX+yCR8ZkNam7vwR2fhP56CNziOYHoljxmdQ2raeHsZ4l+tI9lrKrNgbF7bL8/AfzSZgww9U6b+8ISyI91gYlHxlCt4voh4YwdMToDUixno1ifTenb7HivQ+7eMcGUdyUlbmuo9d3lGEpEJpWHhnD/7YaSmJVqkTKu4f43Avt6nLLyHzwVerNT1pLV9tRfWj3/A6X6AzoVrsH6+Ba9/FGmrk2coHx23EDxbkEbu3WG4fSOyDSuXpVkOaLvKxL58B9Yv3bB/uwvzu6tilhy1cg2zNNVDvNeUZu6dIVi/lkQlab7Oq5hlqqBAPR9u70Pp6Q2Mwb7Rh8wLzorCYAFuNuA/nZEOzJDiF6vohiJTdotz8z6sS7elbRbFaH35PVpfXcgp84BmZhEYSLtQKy567fDTz6XTqTwnbdGmlqRK0zc++BiNDz/JMyxuZtmtrh4JzGcu89xlbBkfofnZF2fF6Ti6iA7wHozprPPDdW2j0Civoi+7UB/n9oBuTy0H5vkr6uOzavtyAwvD7mHG72h4WknTEgW3ZxDxzoH6+1TLN7F0gtVVglMahP37PVW+eH8G+OaXJqZ92F5u77C0pMbsecbQxPYV2uYW2l9fFCNmGzcOkBy3zygXgMlrU23FuUiamjDTK3IAJxPtRBdYl7phftslYPvG37C7emQhg/34vkUPcvKQPikRmA5w7z+Bea5LVabO2qVBtL/5SWcasMoyYEekypSeLOzEzLSHJ9Q9pCe/lgbQuXhT3SItr91TgQxOWQ3IyWWk7U4+fSs1FBfF2we5jkkir7LndVmc5O06tSw/+o8mNBMM9iFt8L7FKhc9Wrjg7c7hYKauyeGJLvP6yzDi3aYGLHtVU5ffF8vJLWQ5GrgcErpgt4loffvUFbQY5UkOjvPL//+m/AftO0X/R8gIQgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Attraction Repulsion Behavior anuraghazra.github.io\"\n        title=\"Attraction Repulsion Behavior anuraghazra.github.io\"\n        src=\"/static/935dca25bf391f1a9ba931ef63df78bb/72799/example2.png\"\n        srcset=\"/static/935dca25bf391f1a9ba931ef63df78bb/12f09/example2.png 148w,\n/static/935dca25bf391f1a9ba931ef63df78bb/e4a3f/example2.png 295w,\n/static/935dca25bf391f1a9ba931ef63df78bb/72799/example2.png 320w\"\n        sizes=\"(max-width: 320px) 100vw, 320px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Attraction Repulsion Behavior anuraghazra.github.io</figcaption>\n  </figure>\r\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 133px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/30c8f50c1d3ee945ea02e660ca28e51f/8ddb9/example3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 200%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAYAAAD+MdrbAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEMklEQVRIx+1W3WscVRTfP0N8kBZB8AO0SB5aEUSUVlGsaMVWLWL1pdEXC2JV0qdUhJZG+iCVUgmtL5V+EDRqbRJrbNI13TabNV+72TTJ7uzsx+z3dndn7r3zk3vuzmaSzG5W0TcHhr175tzfnPM7v3Pu+PAvX77/Af8bQNu26W6uGVe329ZYdwxIv8Ju/ezvALrB7Fod1YERVAdHYVusLdjmEVoMxoEexO55iu7sB0f/Ycqc0299bBLxe5+Gvm0P9EdfQXzrTpjB+YaP6AyQ3t5wNkMRaPc/h8zjryPz2B5oD70EFo01KBGeUfpcSK5iiCZosfdrGDv2w3hiP8onzjYzkD5efPpa8ScvoaVV6ud+gHl5ZI2tVXF8Xtpj8RTqP/0OsZQAanWU3ulB6WAvUDchonHUBkfB9Ez7CB0By6t86jyyT74NPhUGn46ieqwftb5vIWYWwQMzlH7l3PdqX2OPZ8rO20QiDevKOOx8CXaxAj4WBL8Rgl2+CztXhDXkh9CNzTlsAqayFI18O5Ngt2bBJ+fA/SGyychFshPARneIhRiBEJ83psCuBcB+C4AHlI1PTEPEkp0AKinwmUWIhRW1nr0D9vMY2I/XwefuNJ5HweeXPPt9rQ4dwMl5iEVNRTgyQRHxmzMUJWWwqFHa7iC8q+wABuchtBQVhV31K07TObBfxmGXKhDxFPjtOc+O8UxZRJYpbR6KqPQloFFo/I9S6pLnTSMksLqJWv8AmJRJsUw6FIkMgcq1XSiDXZ9E9fRFCNPaUJhVQGcg3J5Ftmsf2OAoiZiNByHCyxQRG70FEQzDujQMo2sfzNBGHn1ek7h86Djyb32C2plLsFeSKB7+EqXPTsJe0VH96jxyez9C+dOTsNcNlZYRpre9Bn3LLmRfPUS2Sv9As9WM5w9C37IT6a69sMJLbSJ0KqylkHnmPSS27kLpw2OAu1cthmJ3Lz0zXnwfPFvYoEXPeWiNB1H77grYtZtUBGcSkYx+nVDPJqY3nzZqejAIPUPckcBjSaJDDlW55sEw7GWdKu8cFd4cug4mkkhgVsmkUlU6TBqw79bApyLU51LozuhqD2ha5CwB7YQaoiSbiOptaVsFZB0A1k3izbw4BHPIrwoVWQU0h/0wL1xV3LYVtitCSX6huxfZAz2wq3VqO2HkgZqJ3LtHUOg+qgCtTgAl+UsaLDllYklVFGmXqcuiaClYw3+Qj9fJ59vwccQFNT8VxMjTdGm+tFiBLYfEnwvk4wZ09jcBZQiOUfawHE+yuus3NBXQmOjrP558XmesJF2EIsruAnQ8pBbNC0Oe57MrQmXMfXwCmQd3o/TFmTUD1D2AS5+fJp/84b4WKTt9rGeQeHg3Evc9i+SON9fIwi0rffsb5JN45GVwhxaxjkPHUDzeD+2BF2jCtIqw/M1l8in1nW2CORH+BcuR4Gg2VkcUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"RagDoll anuraghazra.github.io\"\n        title=\"RagDoll anuraghazra.github.io\"\n        src=\"/static/30c8f50c1d3ee945ea02e660ca28e51f/8ddb9/example3.png\"\n        srcset=\"/static/30c8f50c1d3ee945ea02e660ca28e51f/8ddb9/example3.png 133w\"\n        sizes=\"(max-width: 133px) 100vw, 133px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">RagDoll anuraghazra.github.io</figcaption>\n  </figure>\r\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 339px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35b26c6b121352319fc7cbfc61d51bf9/16caa/example4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 110.8108108108108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACOUlEQVQ4y62VWW/aQBDH+f6foaqUcCb4SAwOYBvDSw7Sp5ZWTYAcJKkq9aEPrbzr2OCJZnbXZ1CjtkjLrGf//s2OZ49akiTwv37IqiEu+rSAePUA0cdriK/uIPq8gmi+hAj76FvcZxb9X1YQfb2FaL6AeLmmsSTeELSGf8+zOQT7FnBzDEx3yVJfc4EfT4B1HeBHvhiTlhme0HSGNJ6IKQpgfH0HQaMvQMcTYa0pcNMHbk0gtKYQot+aEJA0aBF+MARueFnKBFw9AFNAFGJ0CWbmGNbvDuFXd0RQpjSUhQ+sfUKWgFsFvH3KgNh0L30JAd/3TPitOSJ9mSoFxRm2dgHrfeBGEcjk8zOlP5a+HBADNm2yO4CegCLQFEBqKQAL4mVB/wTE6DQDWWmmAmBx5GwJaJSAlaLcPAKr914FVlLEMaUxJFB3q8AAgboEaG8FesAaNukryybY74kFq0ugIdIrpGiIxU5+1KDF1dF1dgBJ7JKAy5fUi1wBuo4ITM8uAXFxF4HLNW09EmsloC6BegkotQRsD14D9lJxBZj/ZukMc8CWTXu5CKz3sqi5tBQ0tXmNAjbt0uGwyM0wL34rsNEvAVXKmkxZk+mpqlPKwuarTK1p06YoAPGwDN6bdHLQ+dY6ocrhx2adAbCDkegfjsRYR/rbA1HMPasI3Pz4Sedf6M+AD08hHM8gdM+BO+ei75xB6F+SL/SwXQBH3/QD7XM8S5ONPLH/9U5JtluI778VrwCE/m0rX1IvW/MbiBxYXwQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Cloth anuraghazra.github.io\"\n        title=\"Cloth anuraghazra.github.io\"\n        src=\"/static/35b26c6b121352319fc7cbfc61d51bf9/16caa/example4.png\"\n        srcset=\"/static/35b26c6b121352319fc7cbfc61d51bf9/12f09/example4.png 148w,\n/static/35b26c6b121352319fc7cbfc61d51bf9/e4a3f/example4.png 295w,\n/static/35b26c6b121352319fc7cbfc61d51bf9/16caa/example4.png 339w\"\n        sizes=\"(max-width: 339px) 100vw, 339px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Cloth anuraghazra.github.io</figcaption>\n  </figure></p>\n<p>Codepen examples:</p>\n<iframe src=\"https://codepen.io/anuraghazra/embed/preview/vwmLKo?default-tab=results\" style=\"width:100%; height:300px;\"></iframe>\n<p>Verly.js’s API is easy to use and flexible because of its Entity Component\r\nStructure.</p>\n<p>Thanks for reading — I hope you learned something!</p>\n<hr>\n<h3 id=\"Other-places-to-learn-about-Verlet-physics\" style=\"position:relative;\"><a href=\"#Other-places-to-learn-about-Verlet-physics\" aria-label=\"Other places to learn about Verlet physics permalink\" class=\"gatsby-remark-autolink before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Other places to learn about Verlet physics:</h3>\n<blockquote>\n<p><a href=\"https://www.youtube.com/watch?v=3HjO_RGIjCU\">Keith Peter’s CodingMath Verlet Physics Videos.</a></p>\n</blockquote>\n<blockquote>\n<p>Amazing\r\n<a href=\"http://datagenetics.com/blog/july22018/index.html\">Article At DataGenetic</a></p>\n</blockquote>","timeToRead":9,"id":"39279841-d170-5558-94ac-d84e48fc88d0","frontmatter":{"date":"August 04, 2021","title":"Making a Verlet Physics Engine in Javascript"}}},"pageContext":{"slug":"/blog/making-a-verlet-physics-engine-in-javascript"}},"staticQueryHashes":["1033876704","1048528189","1171132337","2312248967","3004019075","3435786681","3983789453","550521386","593719826","678625474"]}